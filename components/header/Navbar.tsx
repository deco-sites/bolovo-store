import type { Props as SearchbarProps } from "$store/components/search/Searchbar.tsx";
import Icon, { AvailableIcons } from "$store/components/ui/Icon.tsx";
import { MenuButton, SearchButton } from "$store/islands/Header/Buttons.tsx";
import CartButtonLinx from "$store/islands/Header/Cart/linx.tsx";
import CartButtonShopify from "$store/islands/Header/Cart/shopify.tsx";
import CartButtonVDNA from "$store/islands/Header/Cart/vnda.tsx";
import CartButtonVTEX from "$store/islands/Header/Cart/vtex.tsx";
import CartButtonWake from "$store/islands/Header/Cart/wake.tsx";
import Searchbar from "$store/islands/Header/Searchbar.tsx";
import { usePlatform } from "$store/sdk/usePlatform.tsx";
import type { NavItemProps } from "./NavItem.tsx";
import Image from "apps/website/components/Image.tsx";
import NavItem from "./NavItem.tsx";
import { navbarHeight } from "./constants.ts";
import LanguageSwitcher from "$store/islands/Header/ButtonLanguage.tsx";
import type { Country } from "./Header.tsx";
import DrawerSearch from "$store/islands/Header/DrawerSearch.tsx";
import type { ContentBlogItem } from "./ContentItem.tsx";
import ContentItem from "./ContentItem.tsx";

function Navbar(
  {
    items,
    contentItem,
    searchbar,
    logo,
    helpItem,
    countryFlag,
    label,
    img,
    accountHref,
  }: {
    items: NavItemProps[];
    contentItem: ContentBlogItem;
    searchbar?: SearchbarProps;
    logo?: { src: string; alt: string };
    helpItem: { text: string; href: string };
    accountHref: string;
    countryFlag: Country[];
  },
) {
  const platform = usePlatform();

  return (
    <>
      {/* Mobile Version */}
      <div
        style={{ height: navbarHeight }}
        class="lg:hidden flex flex-row items-center border-b border-base-200 w-screen justify-between px-[15px] md:pl-2  relative"
      >
        <MenuButton />
        {logo && (
          <a
            href="/"
            class="inline-flex items-center justify-center ml-14"
            style={{ minHeight: navbarHeight }}
            aria-label="Store logo"
          >
            <svg id="StoreLogo" viewBox="0 0 400 90" width="111.11" height="24.85">
                <path fill-rule="evenodd" class="ashp0" d="M68.19 40.88c4.07 1.63 6.84 4.26 8.38 7.7 1.54 3.44 1.81 7.73.72 12.73-.26 1.28-.6 2.54-1.01 3.77-.42 1.23-.92 2.44-1.48 3.61-.57 1.17-1.21 2.31-1.93 3.4-.71 1.09-1.49 2.14-2.33 3.13-.55.67-1.13 1.31-1.73 1.93-.6.63-1.22 1.23-1.86 1.8a34.958 34.958 0 0 1-4.11 3.16c-.81.53-1.65 1.02-2.52 1.47-.86.45-1.74.85-2.64 1.22-.9.36-1.82.68-2.75.96-.93.27-1.88.5-2.83.69-1.03.22-2.07.41-3.12.57-1.04.16-2.09.3-3.14.41-1.05.11-2.11.2-3.16.25-1.06.06-2.11.09-3.17.09L0 87.86 18.3.77 60.57.68c10.62.11 17.49 3.11 20.62 9.11 1.95 3.71 2.36 8.2 1.36 13.32-1.18 5.3-3.4 9.6-6.8 12.77-.54.53-1.11 1.04-1.7 1.52-.59.47-1.21.92-1.84 1.34-.64.42-1.29.81-1.96 1.17-.67.35-1.36.68-2.06.97zm-12.67 9.96c-1.9-.99-4.71-1.49-8.47-1.49h-21.7l-4.8 23.2h21.34c3.85-.05 6.88-.46 9.19-1.54 4.31-1.92 6.94-5.58 8.11-10.92 1-4.44-.31-7.62-3.67-9.25zm9.2-25.72c.85-4.06-.19-6.75-3-8.06-.83-.24-1.66-.44-2.5-.62-.84-.17-1.69-.31-2.55-.42-.85-.12-1.7-.19-2.56-.24-.86-.05-1.72-.06-2.58-.04l-19.12.05-4 19.21 21.36-.08c.85.03 1.69 0 2.53-.08.85-.08 1.68-.21 2.51-.4a21.1 21.1 0 0 0 2.43-.72c.79-.29 1.57-.63 2.32-1.02 2.67-1.45 4.39-3.99 5.21-7.61l-.05.03zM143.87 31.23c4.08 6.75 5.08 14.86 3.13 24.1-.46 2.3-1.1 4.56-1.9 6.76a47.99 47.99 0 0 1-2.9 6.41 48.28 48.28 0 0 1-3.83 5.89 46.477 46.477 0 0 1-4.67 5.25c-6.82 6.75-15.76 10.11-26.82 10.11s-18.53-3.29-22.61-10c-4.08-6.71-5.08-14.77-3.08-24.29.48-2.28 1.12-4.52 1.93-6.71.8-2.18 1.77-4.3 2.89-6.34 1.12-2.05 2.39-4 3.79-5.86 1.41-1.85 2.95-3.6 4.62-5.23 6.86-6.84 15.76-10.24 26.86-10.24s18.62 3.31 22.56 10.15m-14.54 24.1c1.41-6.43 1.1-11.46-.81-14.9-1.91-3.44-5.29-5.21-10.29-5.21-1.16-.02-2.32.09-3.45.31-1.14.23-2.25.57-3.32 1.02-1.06.46-2.08 1.03-3.03 1.69-.94.67-1.82 1.43-2.61 2.28-3.35 3.49-5.79 8.38-7.11 14.9-1.32 6.52-1.04 11.56.86 15 1.9 3.44 5.34 5.25 10.23 5.25 1.16.01 2.33-.09 3.47-.32 1.14-.23 2.26-.58 3.33-1.04a16.765 16.765 0 0 0 5.66-3.99c3.4-3.53 5.71-8.47 7.07-14.95v-.04z"></path>
                <path class="ashp0" d="M163.64.33l-18.21 87.08 16.85-.05L180.5.28l-16.86.05z"></path>
                <path fill-rule="evenodd" class="ashp0" d="M214.21 20.8c11.05 0 18.48 3.34 22.56 10.14 4.08 6.8 5.08 14.82 3.08 24.11-.45 2.3-1.08 4.56-1.88 6.77-.79 2.2-1.76 4.35-2.88 6.41a45.565 45.565 0 0 1-3.81 5.89 46.598 46.598 0 0 1-4.66 5.26c-6.86 6.7-15.8 10.05-26.86 10.1-11.06.05-18.61-3.29-22.61-10s-5-14.77-3-24.24c.47-2.28 1.11-4.53 1.92-6.71a46.643 46.643 0 0 1 6.69-12.21c1.41-1.86 2.95-3.6 4.62-5.23 6.87-6.84 15.81-10.19 26.87-10.28m8.02 34.26c1.4-6.43 1.05-11.27-.86-14.81-1.91-3.54-5.29-5.26-10.29-5.26-1.16-.02-2.32.08-3.46.31-1.14.22-2.26.57-3.33 1.02-1.06.46-2.08 1.03-3.03 1.7-.95.68-1.82 1.44-2.61 2.3-3.39 3.49-5.83 8.42-7.15 14.9-1.32 6.48-1.08 11.46.86 14.95 1.94 3.49 5.34 5.26 10.28 5.26 1.16.01 2.32-.1 3.46-.32 1.14-.23 2.25-.58 3.32-1.04 1.06-.46 2.08-1.03 3.03-1.7.95-.67 1.82-1.44 2.61-2.29 3.35-3.54 5.75-8.52 7.11-15l.06-.02z"></path>
                <path class="ashp0" d="M291.13 22.66l-23.65 47.48-3.4-47.39h-18.93l9.6 64.38 17.81-.04 36.65-64.52-18.08.09z"></path>
                <path fill-rule="evenodd" class="ashp0" d="M363.44 30.57c3.99 6.8 5.08 14.91 3.08 24.15a46.638 46.638 0 0 1-8.58 19.03 47.295 47.295 0 0 1-4.65 5.25c-6.87 6.71-15.77 10.05-26.87 10.11-11.1.06-18.57-3.3-22.6-10-4.03-6.7-5.03-14.76-3.08-24.19.48-2.28 1.12-4.53 1.93-6.72.81-2.19 1.78-4.32 2.91-6.36a47.016 47.016 0 0 1 8.43-11.11c6.87-6.84 15.81-10.19 26.87-10.19 11.12-.1 18.57 3.23 22.56 10.03zM348.85 54.7c1.4-6.43 1.08-11.32-.82-14.81s-5.34-5.3-10.28-5.21c-1.16-.02-2.31.07-3.45.29-1.14.22-2.25.56-3.32 1.01a16.54 16.54 0 0 0-5.64 3.95c-3.4 3.44-5.81 8.34-7.12 14.86-1.31 6.52-1.05 11.46.86 14.95 1.91 3.49 5.35 5.26 10.24 5.26 1.17.02 2.33-.08 3.48-.3 1.14-.22 2.26-.57 3.33-1.02a16.85 16.85 0 0 0 5.68-3.99c3.36-3.49 5.76-8.43 7.07-14.95l-.03-.04zM400 29.41a13.25 13.25 0 0 1-3.84 9.37 13.243 13.243 0 0 1-9.35 3.9c-3.5.02-6.87-1.37-9.36-3.84-2.49-2.47-3.9-5.83-3.91-9.34.01-1.72.37-3.43 1.04-5.02a13.19 13.19 0 0 1 2.9-4.23c1.23-1.2 2.7-2.15 4.3-2.78 1.6-.64 3.32-.95 5.04-.92 1.72-.04 3.42.26 5.02.89 1.59.63 3.05 1.57 4.28 2.76 1.23 1.2 2.2 2.63 2.87 4.22.67 1.58 1.01 3.27 1.01 4.99zm-23.15.09c-.04 1.34.2 2.67.69 3.91a9.839 9.839 0 0 0 2.17 3.33 9.85 9.85 0 0 0 3.3 2.22c1.23.51 2.56.76 3.9.74a9.81 9.81 0 0 0 7.03-3.03c.91-.96 1.62-2.08 2.08-3.31.47-1.23.68-2.55.63-3.86 0-5.7-4.17-10.37-9.83-10.37-1.34 0-2.68.27-3.91.79-1.24.53-2.36 1.3-3.3 2.27-.93.97-1.66 2.11-2.14 3.37-.48 1.26-.7 2.6-.65 3.94h.03zm7.9 6.66h-3l-.05-12.86c.41-.07.83-.13 1.24-.18.42-.04.83-.08 1.25-.11.42-.03.84-.05 1.26-.07.41-.01.83-.01 1.25 0 .39-.05.78-.06 1.17-.05.39.02.77.07 1.15.15.39.08.76.19 1.12.34.37.14.72.31 1.05.51.2.17.38.36.53.57.16.21.29.43.4.67.1.24.18.49.23.74.05.26.07.52.06.78-.03.36-.12.71-.27 1.05a3.3 3.3 0 0 1-.58.9c-.25.27-.53.5-.85.68-.31.18-.65.3-1.01.37v.13c1.35.46 2 1.41 2.44 3.13.41 2 .59 2.72.95 3.21h-3.19c-.12-.25-.24-.5-.34-.76-.11-.26-.2-.52-.28-.79-.09-.26-.16-.53-.22-.8-.07-.27-.12-.54-.16-.82-.22-1.31-1.08-2-2.67-2h-1.4l-.08 5.21zm.09-7.29h1.4c1.59 0 3-.59 3-1.9 0-1.13-.86-1.95-2.72-1.95h-.41l-.41.03-.41.06-.4.09-.05 3.67z"></path>
              </svg> 
          </a>
        )}
        <div class="flex items-center gap-[7px] ">
          <span class="mr-1 mt-[2px]">
            <DrawerSearch searchbar={searchbar} />
            <SearchButton label={label} img={img} />
          </span>
          <a
            class="btn btn-circle w-auto btn-sm btn-ghost hover:bg-transparent"
            href={accountHref}
            aria-label="Log in"
          >
            <Icon id="User" size={21} strokeWidth={0.4} />
          </a>
          {platform === "vtex" && <CartButtonVTEX />}
          {platform === "vnda" && <CartButtonVDNA />}
        </div>
      </div>

      {/* Desktop Version */}
      <div class="hidden lg:flex flex-row justify-between items-center w-full px-[15px]  shadow-sm shadow-gray-300">
        <div class="flex items-center px-0 w-2/6">
          {items.map((item) => <NavItem {...item} />)}
          <ContentItem item={contentItem} />
        </div>
        <div class="flex-auto flex justify-center w-2/6">
          {logo && (
            <a
              href="/"
              aria-label="Store logo"
              class="block w-[145px]"
            >
              <svg id="StoreLogo" viewBox="0 0 400 90" width="111.11" height="24.85">
                <path fill-rule="evenodd" class="ashp0" d="M68.19 40.88c4.07 1.63 6.84 4.26 8.38 7.7 1.54 3.44 1.81 7.73.72 12.73-.26 1.28-.6 2.54-1.01 3.77-.42 1.23-.92 2.44-1.48 3.61-.57 1.17-1.21 2.31-1.93 3.4-.71 1.09-1.49 2.14-2.33 3.13-.55.67-1.13 1.31-1.73 1.93-.6.63-1.22 1.23-1.86 1.8a34.958 34.958 0 0 1-4.11 3.16c-.81.53-1.65 1.02-2.52 1.47-.86.45-1.74.85-2.64 1.22-.9.36-1.82.68-2.75.96-.93.27-1.88.5-2.83.69-1.03.22-2.07.41-3.12.57-1.04.16-2.09.3-3.14.41-1.05.11-2.11.2-3.16.25-1.06.06-2.11.09-3.17.09L0 87.86 18.3.77 60.57.68c10.62.11 17.49 3.11 20.62 9.11 1.95 3.71 2.36 8.2 1.36 13.32-1.18 5.3-3.4 9.6-6.8 12.77-.54.53-1.11 1.04-1.7 1.52-.59.47-1.21.92-1.84 1.34-.64.42-1.29.81-1.96 1.17-.67.35-1.36.68-2.06.97zm-12.67 9.96c-1.9-.99-4.71-1.49-8.47-1.49h-21.7l-4.8 23.2h21.34c3.85-.05 6.88-.46 9.19-1.54 4.31-1.92 6.94-5.58 8.11-10.92 1-4.44-.31-7.62-3.67-9.25zm9.2-25.72c.85-4.06-.19-6.75-3-8.06-.83-.24-1.66-.44-2.5-.62-.84-.17-1.69-.31-2.55-.42-.85-.12-1.7-.19-2.56-.24-.86-.05-1.72-.06-2.58-.04l-19.12.05-4 19.21 21.36-.08c.85.03 1.69 0 2.53-.08.85-.08 1.68-.21 2.51-.4a21.1 21.1 0 0 0 2.43-.72c.79-.29 1.57-.63 2.32-1.02 2.67-1.45 4.39-3.99 5.21-7.61l-.05.03zM143.87 31.23c4.08 6.75 5.08 14.86 3.13 24.1-.46 2.3-1.1 4.56-1.9 6.76a47.99 47.99 0 0 1-2.9 6.41 48.28 48.28 0 0 1-3.83 5.89 46.477 46.477 0 0 1-4.67 5.25c-6.82 6.75-15.76 10.11-26.82 10.11s-18.53-3.29-22.61-10c-4.08-6.71-5.08-14.77-3.08-24.29.48-2.28 1.12-4.52 1.93-6.71.8-2.18 1.77-4.3 2.89-6.34 1.12-2.05 2.39-4 3.79-5.86 1.41-1.85 2.95-3.6 4.62-5.23 6.86-6.84 15.76-10.24 26.86-10.24s18.62 3.31 22.56 10.15m-14.54 24.1c1.41-6.43 1.1-11.46-.81-14.9-1.91-3.44-5.29-5.21-10.29-5.21-1.16-.02-2.32.09-3.45.31-1.14.23-2.25.57-3.32 1.02-1.06.46-2.08 1.03-3.03 1.69-.94.67-1.82 1.43-2.61 2.28-3.35 3.49-5.79 8.38-7.11 14.9-1.32 6.52-1.04 11.56.86 15 1.9 3.44 5.34 5.25 10.23 5.25 1.16.01 2.33-.09 3.47-.32 1.14-.23 2.26-.58 3.33-1.04a16.765 16.765 0 0 0 5.66-3.99c3.4-3.53 5.71-8.47 7.07-14.95v-.04z"></path>
                <path class="ashp0" d="M163.64.33l-18.21 87.08 16.85-.05L180.5.28l-16.86.05z"></path>
                <path fill-rule="evenodd" class="ashp0" d="M214.21 20.8c11.05 0 18.48 3.34 22.56 10.14 4.08 6.8 5.08 14.82 3.08 24.11-.45 2.3-1.08 4.56-1.88 6.77-.79 2.2-1.76 4.35-2.88 6.41a45.565 45.565 0 0 1-3.81 5.89 46.598 46.598 0 0 1-4.66 5.26c-6.86 6.7-15.8 10.05-26.86 10.1-11.06.05-18.61-3.29-22.61-10s-5-14.77-3-24.24c.47-2.28 1.11-4.53 1.92-6.71a46.643 46.643 0 0 1 6.69-12.21c1.41-1.86 2.95-3.6 4.62-5.23 6.87-6.84 15.81-10.19 26.87-10.28m8.02 34.26c1.4-6.43 1.05-11.27-.86-14.81-1.91-3.54-5.29-5.26-10.29-5.26-1.16-.02-2.32.08-3.46.31-1.14.22-2.26.57-3.33 1.02-1.06.46-2.08 1.03-3.03 1.7-.95.68-1.82 1.44-2.61 2.3-3.39 3.49-5.83 8.42-7.15 14.9-1.32 6.48-1.08 11.46.86 14.95 1.94 3.49 5.34 5.26 10.28 5.26 1.16.01 2.32-.1 3.46-.32 1.14-.23 2.25-.58 3.32-1.04 1.06-.46 2.08-1.03 3.03-1.7.95-.67 1.82-1.44 2.61-2.29 3.35-3.54 5.75-8.52 7.11-15l.06-.02z"></path>
                <path class="ashp0" d="M291.13 22.66l-23.65 47.48-3.4-47.39h-18.93l9.6 64.38 17.81-.04 36.65-64.52-18.08.09z"></path>
                <path fill-rule="evenodd" class="ashp0" d="M363.44 30.57c3.99 6.8 5.08 14.91 3.08 24.15a46.638 46.638 0 0 1-8.58 19.03 47.295 47.295 0 0 1-4.65 5.25c-6.87 6.71-15.77 10.05-26.87 10.11-11.1.06-18.57-3.3-22.6-10-4.03-6.7-5.03-14.76-3.08-24.19.48-2.28 1.12-4.53 1.93-6.72.81-2.19 1.78-4.32 2.91-6.36a47.016 47.016 0 0 1 8.43-11.11c6.87-6.84 15.81-10.19 26.87-10.19 11.12-.1 18.57 3.23 22.56 10.03zM348.85 54.7c1.4-6.43 1.08-11.32-.82-14.81s-5.34-5.3-10.28-5.21c-1.16-.02-2.31.07-3.45.29-1.14.22-2.25.56-3.32 1.01a16.54 16.54 0 0 0-5.64 3.95c-3.4 3.44-5.81 8.34-7.12 14.86-1.31 6.52-1.05 11.46.86 14.95 1.91 3.49 5.35 5.26 10.24 5.26 1.17.02 2.33-.08 3.48-.3 1.14-.22 2.26-.57 3.33-1.02a16.85 16.85 0 0 0 5.68-3.99c3.36-3.49 5.76-8.43 7.07-14.95l-.03-.04zM400 29.41a13.25 13.25 0 0 1-3.84 9.37 13.243 13.243 0 0 1-9.35 3.9c-3.5.02-6.87-1.37-9.36-3.84-2.49-2.47-3.9-5.83-3.91-9.34.01-1.72.37-3.43 1.04-5.02a13.19 13.19 0 0 1 2.9-4.23c1.23-1.2 2.7-2.15 4.3-2.78 1.6-.64 3.32-.95 5.04-.92 1.72-.04 3.42.26 5.02.89 1.59.63 3.05 1.57 4.28 2.76 1.23 1.2 2.2 2.63 2.87 4.22.67 1.58 1.01 3.27 1.01 4.99zm-23.15.09c-.04 1.34.2 2.67.69 3.91a9.839 9.839 0 0 0 2.17 3.33 9.85 9.85 0 0 0 3.3 2.22c1.23.51 2.56.76 3.9.74a9.81 9.81 0 0 0 7.03-3.03c.91-.96 1.62-2.08 2.08-3.31.47-1.23.68-2.55.63-3.86 0-5.7-4.17-10.37-9.83-10.37-1.34 0-2.68.27-3.91.79-1.24.53-2.36 1.3-3.3 2.27-.93.97-1.66 2.11-2.14 3.37-.48 1.26-.7 2.6-.65 3.94h.03zm7.9 6.66h-3l-.05-12.86c.41-.07.83-.13 1.24-.18.42-.04.83-.08 1.25-.11.42-.03.84-.05 1.26-.07.41-.01.83-.01 1.25 0 .39-.05.78-.06 1.17-.05.39.02.77.07 1.15.15.39.08.76.19 1.12.34.37.14.72.31 1.05.51.2.17.38.36.53.57.16.21.29.43.4.67.1.24.18.49.23.74.05.26.07.52.06.78-.03.36-.12.71-.27 1.05a3.3 3.3 0 0 1-.58.9c-.25.27-.53.5-.85.68-.31.18-.65.3-1.01.37v.13c1.35.46 2 1.41 2.44 3.13.41 2 .59 2.72.95 3.21h-3.19c-.12-.25-.24-.5-.34-.76-.11-.26-.2-.52-.28-.79-.09-.26-.16-.53-.22-.8-.07-.27-.12-.54-.16-.82-.22-1.31-1.08-2-2.67-2h-1.4l-.08 5.21zm.09-7.29h1.4c1.59 0 3-.59 3-1.9 0-1.13-.86-1.95-2.72-1.95h-.41l-.41.03-.41.06-.4.09-.05 3.67z"></path>
              </svg>
            </a>
          )}
        </div>
        <div class="flex-none flex items-center justify-end gap-1 pr-0 min-w-[33%] w-auto">
          <SearchButton label={label} img={img} />
          <Searchbar searchbar={searchbar} />
          <LanguageSwitcher countryFlag={countryFlag} class="w-auto" />
          {helpItem && (
            <a
              class="btn btn-sm btn-ghost px-2 hover:bg-transparent font-normal text-base uppercase"
              href={helpItem.href}
              aria-label="Help"
            >
              {helpItem.text}
            </a>
          )}
          <a
            class="btn btn-circle px-2 w-auto btn-sm btn-ghost hover:bg-transparent"
            href={accountHref}
            aria-label="Log in"
          >
            <Icon id="User" width={20} height={24} strokeWidth={0.4} />
          </a>
          {platform === "vtex" && <CartButtonVTEX />}
          {platform === "vnda" && <CartButtonVDNA />}
          {platform === "wake" && <CartButtonWake />}
          {platform === "linx" && <CartButtonLinx />}
          {platform === "shopify" && <CartButtonShopify />}
        </div>
      </div>
    </>
  );
}

export default Navbar;
